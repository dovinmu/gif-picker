# Replace with your domain (or use :80 for HTTP-only testing)
honeycomb.example.com {
    # Proxy API requests to Antfly (must be before file_server)
    handle /api/* {
        reverse_proxy localhost:8080
    }

    # Proxy termite requests (strip prefix)
    handle /termite/* {
        uri strip_prefix /termite
        reverse_proxy localhost:11433
    }

    # Static frontend (catch-all)
    handle {
        root * /var/www/honeycomb
        try_files {path} /index.html
        file_server
    }

    encode gzip

    header {
        X-Content-Type-Options nosniff
        X-Frame-Options DENY
        Referrer-Policy strict-origin-when-cross-origin
    }
}

# Antfly admin dashboard on subdomain (no asset path conflicts)
admin.honeycomb.example.com {
    reverse_proxy localhost:8080

    encode gzip

    header {
        X-Content-Type-Options nosniff
        X-Frame-Options DENY
        Referrer-Policy strict-origin-when-cross-origin
    }
}
